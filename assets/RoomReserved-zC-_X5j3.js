import{m as x,i as N,j as v,C as E,l as I,_ as V,r as D,G as w,o as r,c as l,b as e,t as a,z as c,H as y,F as p,g,f,a as b,q as C,A as h,I as L,p as H,e as S}from"./index-UCbw_oP_.js";import{o as U}from"./orders-KuKHQOxF.js";import{C as R}from"./cityCountyData-3AYHRziG.js";import{R as M}from"./RoomService-eFol5Qaj.js";import{c as O}from"./validate-yFhYR_ji.js";const T={mixins:[x],data(){return{editPeoPle:!1,isEdit:{roomType:!1,peopleNum:!1,reservationDate:!1},cityIndex:0,form:{roomId:"",range:{start:new Date,end:new Date},checkInDate:0,checkOutDate:0,peopleNum:0,userInfo:{address:{zipcode:0,detail:""},name:"",phone:"",email:""}},CityCountyData:R}},components:{RoomService:M},watch:{"form.roomId":function(o){const t=this.roomList.find(d=>d._id===o);t&&(this.roomInfo.name=t.name)}},computed:{...N(I,["roomInfo","roomList"]),disabledBtn(){const{address:o,name:t,phone:d,email:m}=this.form.userInfo;return!this.form.peopleNum||!o.detail||!t||!d||!m},routeParams(){return this.$route.params},user(){return JSON.parse(localStorage.getItem("user"))}},mounted(){const{id:o,days:t,people:d,startdate:m}=this.routeParams;this.form.roomId=o,this.form.checkInDate=Number(m),this.form.checkOutDate=Number(m)+Number(t)*24*60*60*1e3,this.form.peopleNum=Number(d),this.getRoomInfo(o),this.form.userInfo.address.zipcode=Number(this.CityCountyData[this.cityIndex].AreaList[0].ZipCode),this.getRoomList()},methods:{...v(I,["getRoomInfo","getRoomList"]),...v(U,["postOrder"]),setUserData(){const{address:o,name:t,phone:d,email:m}=JSON.parse(JSON.stringify(this.user));this.form.userInfo.address=o,this.form.userInfo.name=t,this.form.userInfo.phone=d,this.form.userInfo.email=m,this.setCity(o.zipcode)},setCity(o){this.CityCountyData.forEach((t,d)=>{t.AreaList.forEach(m=>{Number(m.ZipCode)===Number(o)&&(this.cityIndex=d)})})},createOrder(){if(!O(this.form.userInfo.email))return;const o={year:"numeric",month:"2-digit",day:"2-digit"},{name:t,phone:d,email:m,address:i}=this.form.userInfo;if(!t||!d||!m||!i.zipcode||!i.detail){E.fire({icon:"error",title:"有資訊未填寫"});return}this.postOrder({...this.form,checkInDate:new Date(this.form.checkInDate).toLocaleDateString("zh-TW",o),checkOutDate:new Date(this.form.checkOutDate).toLocaleDateString("zh-TW",o)}).then(()=>{this.$router.push("/BookingResult")})},toggleEdit(o){this.isEdit[o]=!this.isEdit[o]},updateDate(){this.form.checkInDate=Number(this.form.range.start),this.form.checkOutDate=Number(this.form.range.end),this.toggleEdit("reservationDate")},cleanDate(){this.form.range={start:new Date,end:new Date}}}},Z="data:image/svg+xml,%3csvg%20width='13'%20height='20'%20viewBox='0%200%2013%2020'%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%3e%3cpath%20d='M12.682%2017.65L5.0487%2010L12.682%202.35L10.332%200L0.332031%2010L10.332%2020L12.682%2017.65Z'%20fill='black'%20/%3e%3c/svg%3e",j="data:image/svg+xml,%3csvg%20width='20'%20height='17'%20viewBox='0%200%2020%2017'%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%3e%3cpath%20d='M0%203.25C0%202.52065%200.289731%201.82118%200.805456%201.30546C1.32118%200.789731%202.02065%200.5%202.75%200.5H17.25C17.9793%200.5%2018.6788%200.789731%2019.1945%201.30546C19.7103%201.82118%2020%202.52065%2020%203.25V13.75C20%2014.1111%2019.9289%2014.4687%2019.7907%2014.8024C19.6525%2015.136%2019.4499%2015.4392%2019.1945%2015.6945C18.9392%2015.9499%2018.636%2016.1525%2018.3024%2016.2907C17.9687%2016.4289%2017.6111%2016.5%2017.25%2016.5H2.75C2.38886%2016.5%202.03127%2016.4289%201.69762%2016.2907C1.36398%2016.1525%201.06082%2015.9499%200.805456%2015.6945C0.550095%2015.4392%200.347532%2015.136%200.209331%2014.8024C0.0711308%2014.4687%200%2014.1111%200%2013.75V3.25ZM14.78%203.72C14.6395%203.57931%2014.4488%203.50017%2014.25%203.5H11.75C11.5511%203.5%2011.3603%203.57902%2011.2197%203.71967C11.079%203.86032%2011%204.05109%2011%204.25C11%204.44891%2011.079%204.63968%2011.2197%204.78033C11.3603%204.92098%2011.5511%205%2011.75%205H12.44L10.72%206.719C10.6463%206.78766%2010.5872%206.87046%2010.5462%206.96246C10.5052%207.05446%2010.4832%207.15377%2010.4814%207.25448C10.4796%207.35518%2010.4982%207.45521%2010.5359%207.5486C10.5736%207.64199%2010.6297%207.72682%2010.701%207.79804C10.7722%207.86926%2010.857%207.9254%2010.9504%207.96312C11.0438%208.00084%2011.1438%208.01937%2011.2445%208.01759C11.3452%208.01581%2011.4445%207.99377%2011.5365%207.95278C11.6285%207.91179%2011.7113%207.85269%2011.78%207.779L13.5%206.06V6.75C13.5%206.94891%2013.579%207.13968%2013.7197%207.28033C13.8603%207.42098%2014.0511%207.5%2014.25%207.5C14.4489%207.5%2014.6397%207.42098%2014.7803%207.28033C14.921%207.13968%2015%206.94891%2015%206.75V4.25C14.9998%204.05115%2014.9207%203.86052%2014.78%203.72ZM5.75%2013.5H8.251C8.44991%2013.5%208.64068%2013.421%208.78133%2013.2803C8.92198%2013.1397%209.001%2012.9489%209.001%2012.75C9.001%2012.5511%208.92198%2012.3603%208.78133%2012.2197C8.64068%2012.079%208.44991%2012%208.251%2012H7.561L9.281%2010.28C9.41755%2010.1385%209.49306%209.949%209.49126%209.75235C9.48946%209.5557%209.41049%209.36763%209.27137%209.22864C9.13225%209.08965%208.9441%209.01086%208.74745%209.00924C8.5508%209.00763%208.36139%209.08331%208.22%209.22L6.5%2010.938V10.248C6.5%2010.0491%206.42098%209.85832%206.28033%209.71767C6.13968%209.57702%205.94891%209.498%205.75%209.498C5.55109%209.498%205.36032%209.57702%205.21967%209.71767C5.07902%209.85832%205%2010.0491%205%2010.248V12.748C5%2012.9469%205.07902%2013.1377%205.21967%2013.2783C5.36032%2013.419%205.55109%2013.498%205.75%2013.498V13.5Z'%20fill='%23BF9D7D'%20/%3e%3c/svg%3e",z="data:image/svg+xml,%3csvg%20width='20'%20height='15'%20viewBox='0%200%2020%2015'%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%3e%3cpath%20d='M18%205.5V2.5C18%201.4%2017.1%200.5%2016%200.5H4C2.9%200.5%202%201.4%202%202.5V5.5C0.9%205.5%200%206.4%200%207.5V12.5H1.33L2%2014.5H3L3.67%2012.5H16.34L17%2014.5H18L18.67%2012.5H20V7.5C20%206.4%2019.1%205.5%2018%205.5ZM9%205.5H4V2.5H9V5.5ZM16%205.5H11V2.5H16V5.5Z'%20fill='%23BF9D7D'%20/%3e%3c/svg%3e",P="data:image/svg+xml,%3csvg%20width='16'%20height='17'%20viewBox='0%200%2016%2017'%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%3e%3cpath%20d='M8%208.5C10.21%208.5%2012%206.71%2012%204.5C12%202.29%2010.21%200.5%208%200.5C5.79%200.5%204%202.29%204%204.5C4%206.71%205.79%208.5%208%208.5ZM8%2010.5C5.33%2010.5%200%2011.84%200%2014.5V16.5H16V14.5C16%2011.84%2010.67%2010.5%208%2010.5Z'%20fill='%23BF9D7D'%20/%3e%3c/svg%3e",n=o=>(H("data-v-a86a3676"),o=o(),S(),o),Y={class:"bg-primary-10"},J={class:"container"},W={class:"row"},q={class:"p-5 d-flex gap-3 align-item-center"},G=n(()=>e("img",{class:"rounded img-fluid",src:Z,alt:"Room Image"},null,-1)),X=[G],K={class:"container"},Q={class:"row mb-10"},$={class:"col-md-7"},ee=n(()=>e("h3",null,"訂房資訊",-1)),te={class:"d-flex justify-content-between"},oe=n(()=>e("p",{class:"sub-title sub-title-primary mb-2"},"選擇房型",-1)),se={key:0},ne=n(()=>e("option",{selected:""},"請選擇",-1)),ie=["value"],re={class:"d-flex py-5 justify-content-between"},le={key:0},ue=n(()=>e("p",{class:"sub-title sub-title-primary mb-2"},"訂房日期",-1)),ae=n(()=>e("br",null,null,-1)),de={key:1,class:"w-100 d-flex flex-column"},me={class:"mt-5 align-self-end"},ce={class:"d-flex justify-content-between"},pe=n(()=>e("p",{class:"sub-title sub-title-primary mb-2"},"房客人數",-1)),fe={key:1},he=n(()=>e("br",null,null,-1)),be=n(()=>e("hr",null,null,-1)),Ce={class:"py-1 d-flex justify-content-between"},_e=n(()=>e("h3",null,"訂房人資訊",-1)),ye={class:"py-5"},ge=n(()=>e("label",{class:"",for:"name"},[e("span",{class:"text-danger me-2"},"*"),f("姓名")],-1)),ve=n(()=>e("div",{class:"py-3"},null,-1)),Ie=n(()=>e("label",{for:"name"},[e("span",{class:"text-danger me-2"},"*"),f("手機號碼")],-1)),De=n(()=>e("div",{class:"py-3"},null,-1)),we=n(()=>e("label",{for:"name"},[e("span",{class:"text-danger me-2"},"*"),f("電子信箱")],-1)),Fe=n(()=>e("div",{class:"py-3"},null,-1)),Ae=n(()=>e("label",{for:"name"},[e("span",{class:"text-danger me-2"},"*"),f("地址")],-1)),Be={class:"d-flex justify-content-between"},ke=["value"],xe=["value"],Ne=n(()=>e("div",{class:"py-3"},null,-1)),Ee=n(()=>e("br",null,null,-1)),Ve=n(()=>e("hr",null,null,-1)),Le=n(()=>e("div",{class:"py-3"},null,-1)),He=n(()=>e("h4",null,"房間資訊",-1)),Se=n(()=>e("div",{class:"py-2"},null,-1)),Ue=n(()=>e("p",{class:"sub-title sub-title-primary"},"房型基本資訊",-1)),Re={class:"d-flex justify-content-center gap-5"},Me={class:"rounded bg-white border border-1 w-25 text-center p-3"},Oe=n(()=>e("img",{class:"rounded img-fluid",src:j,alt:"Room Image"},null,-1)),Te={class:"rounded bg-white border border-1 w-25 text-center p-3"},Ze=n(()=>e("img",{class:"rounded img-fluid",src:z,alt:"Room Image"},null,-1)),je={class:"rounded bg-white border border-1 w-25 text-center p-3"},ze=n(()=>e("img",{class:"rounded img-fluid",src:P,alt:"Room Image"},null,-1)),Pe=n(()=>e("div",{class:"py-3"},null,-1)),Ye=n(()=>e("p",{class:"sub-title sub-title-primary"},"房間格局",-1)),Je={class:"bg-white rounded p-4 text-center"},We=n(()=>e("div",{class:"py-3"},null,-1)),qe=n(()=>e("p",{class:"sub-title sub-title-primary"},"房內設備",-1)),Ge={class:"bg-white rounded p-4 text-center"},Xe=n(()=>e("div",{class:"py-3"},null,-1)),Ke=n(()=>e("p",{class:"sub-title sub-title-primary"},"備品提供",-1)),Qe={class:"bg-white rounded p-4 text-center"},$e={class:"p-5 col-md-5 rounded bg-white h-25 text-black"},et={class:""},tt=["src"],ot=n(()=>e("div",{class:"py-3"},[e("h3",{class:"fw-bold"},"價格詳情")],-1)),st={class:"py-1 d-flex justify-content-between"},nt=n(()=>e("div",{class:"py-2 d-flex justify-content-between"},[e("span",null," 住宿折扣 "),e("span",null," -NT$ 0 ")],-1)),it={class:"py-2 fw-bold d-flex justify-content-between"},rt=n(()=>e("span",null," 總價 ",-1)),lt={class:"d-flex justify-content-center"};function ut(o,t,d,m,i,u){const F=D("VDatePicker"),_=D("RoomService"),A=w("number"),B=w("tel");return r(),l("main",Y,[e("div",J,[e("div",W,[e("div",q,[e("button",{type:"button",class:"p-0 border-0 text-primary",onClick:t[0]||(t[0]=s=>o.$router.push(`/roomdetail/${i.form.roomId}`))},X),e("button",{type:"button",class:"p-0 border-0",onClick:t[1]||(t[1]=s=>o.$router.push(`/roomdetail/${i.form.roomId}`))}," 確認訂房資訊 ")])]),e("div",K,[e("div",Q,[e("div",$,[ee,e("div",te,[e("div",null,[oe,i.isEdit.roomType?c((r(),l("select",{key:1,class:"form-select","onUpdate:modelValue":t[2]||(t[2]=s=>i.form.roomId=s),"aria-label":"select"},[ne,(r(!0),l(p,null,g(o.roomList,s=>(r(),l("option",{key:s._id,value:s._id},a(s.name),9,ie))),128))],512)),[[y,i.form.roomId]]):(r(),l("p",se,a(o.roomInfo.name),1))]),e("button",{type:"button",class:"btn text-decoration-underline",onClick:t[3]||(t[3]=s=>u.toggleEdit("roomType"))},a(i.isEdit.roomType?"確認":"編輯"),1)]),e("div",re,[i.isEdit.reservationDate?(r(),l("div",de,[b(F,{modelValue:i.form.range,"onUpdate:modelValue":t[4]||(t[4]=s=>i.form.range=s),modelModifiers:{range:!0},mode:"date",columns:o.columns,expanded:!0,rows:o.rows,masks:{title:"YYYY 年 MM 月"},timezone:"UTC"},null,8,["modelValue","columns","rows"]),e("div",me,[e("button",{type:"button",class:"btn btn-white p-2 me-2",onClick:t[5]||(t[5]=s=>u.toggleEdit("reservationDate"))}," 取消 "),e("button",{type:"button",class:"btn btn-white p-2 me-2",onClick:t[6]||(t[6]=(...s)=>u.cleanDate&&u.cleanDate(...s))}," 清除日期 "),e("button",{type:"button",class:"btn btn-primary p-2",onClick:t[7]||(t[7]=(...s)=>u.updateDate&&u.updateDate(...s))}," 確定日期 ")])])):(r(),l("div",le,[ue,f(" 入住："+a(o.getDate(i.form.checkInDate))+" ",1),ae,f(" 退房："+a(o.getDate(i.form.checkOutDate)),1)])),i.isEdit.reservationDate?C("",!0):(r(),l("button",{key:2,type:"button",class:"btn text-decoration-underline",onClick:t[8]||(t[8]=s=>u.toggleEdit("reservationDate"))}," 編輯 "))]),e("div",ce,[e("span",null,[pe,i.isEdit.peopleNum?c((r(),l("input",{key:0,type:"text",class:"form-control","onUpdate:modelValue":t[9]||(t[9]=s=>i.form.peopleNum=s)},null,512)),[[A],[h,i.form.peopleNum,void 0,{number:!0}]]):(r(),l("span",fe,a(i.form.peopleNum)+" 人",1))]),e("button",{type:"button",class:"btn text-decoration-underline",onClick:t[10]||(t[10]=s=>u.toggleEdit("peopleNum"))},a(i.isEdit.peopleNum?"確認":"編輯"),1)]),he,be,e("div",Ce,[_e,e("button",{type:"button",class:"p-0 border-0 text-primary text-decoration-underline",onClick:t[11]||(t[11]=(...s)=>u.setUserData&&u.setUserData(...s))}," 套用會員資料 ")]),e("form",ye,[ge,c(e("input",{"onUpdate:modelValue":t[12]||(t[12]=s=>i.form.userInfo.name=s),id:"name",type:"text",class:"form-control",placeholder:"請輸入姓名","aria-label":"Username","aria-describedby":"addon-wrapping"},null,512),[[h,i.form.userInfo.name]]),ve,Ie,c(e("input",{"onUpdate:modelValue":t[13]||(t[13]=s=>i.form.userInfo.phone=s),id:"name",type:"text",class:"form-control",placeholder:"請輸入手機號碼","aria-label":"Username","aria-describedby":"addon-wrapping"},null,512),[[h,i.form.userInfo.phone],[B]]),De,we,c(e("input",{"onUpdate:modelValue":t[14]||(t[14]=s=>i.form.userInfo.email=s),id:"name",type:"text",class:"form-control",placeholder:"請輸入電子信箱","aria-label":"Username","aria-describedby":"addon-wrapping"},null,512),[[h,i.form.userInfo.email]]),Fe,Ae,e("div",Be,[c(e("select",{id:"address",class:"form-select p-3 rounded-3","onUpdate:modelValue":t[15]||(t[15]=s=>i.cityIndex=s)},[(r(!0),l(p,null,g(i.CityCountyData,(s,k)=>(r(),l("option",{key:s.CityName,value:k},a(s.CityName),9,ke))),128))],512),[[y,i.cityIndex]]),c(e("select",{class:"form-select p-3 rounded-3","onUpdate:modelValue":t[16]||(t[16]=s=>i.form.userInfo.address.zipcode=s)},[(r(!0),l(p,null,g(i.CityCountyData[i.cityIndex].AreaList,s=>(r(),l("option",{key:s.ZipCode,value:Number(s.ZipCode)},a(s.AreaName),9,xe))),128))],512),[[y,i.form.userInfo.address.zipcode]])]),Ne,c(e("input",{"onUpdate:modelValue":t[17]||(t[17]=s=>i.form.userInfo.address.detail=s),id:"name",type:"text",class:"form-control",placeholder:"請輸入詳細地址","aria-label":"Username","aria-describedby":"addon-wrapping"},null,512),[[h,i.form.userInfo.address.detail]])]),Ee,Ve,Le,He,Se,Ue,e("div",Re,[e("span",Me,[Oe,e("div",null,a(o.roomInfo.areaInfo),1)]),e("span",Te,[Ze,e("div",null,a(o.roomInfo.bedInfo),1)]),e("span",je,[ze,e("div",null,"1-"+a(o.roomInfo.maxPeople)+" 人",1)])]),Pe,o.roomInfo.layoutInfo?(r(),l(p,{key:0},[Ye,e("div",Je,[b(_,{service:o.roomInfo.layoutInfo},null,8,["service"])]),We],64)):C("",!0),o.roomInfo.facilityInfo?(r(),l(p,{key:1},[qe,e("div",Ge,[b(_,{service:o.roomInfo.facilityInfo},null,8,["service"])]),Xe],64)):C("",!0),o.roomInfo.amenityInfo?(r(),l(p,{key:2},[Ke,e("div",Qe,[b(_,{service:o.roomInfo.amenityInfo},null,8,["service"])])],64)):C("",!0)]),e("div",$e,[e("div",et,[e("img",{class:"rounded img-fluid",src:o.roomInfo.imageUrl},null,8,tt)]),ot,e("div",st,[e("span",null," NT$ "+a(o.roomInfo.price)+" X "+a(u.routeParams.days)+" 晚 ",1),e("span",null," NT$ "+a(o.roomInfo.price*Number(u.routeParams.days)),1)]),nt,e("div",it,[rt,e("span",null," NT$ "+a(o.roomInfo.price*Number(u.routeParams.days)),1)]),e("div",lt,[e("button",{class:L(["btn btn-primary w-100",{disabled:u.disabledBtn}]),onClick:t[18]||(t[18]=(...s)=>u.createOrder&&u.createOrder(...s))},"確認訂房",2)])])])])])])}const ft=V(T,[["render",ut],["__scopeId","data-v-a86a3676"]]);export{ft as default};
